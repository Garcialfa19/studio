/**
 * @file Firebase Security Rules for Firestore.
 *
 * Core Philosophy:
 * This ruleset implements a public read-only model for general users,
 * while allowing any authenticated user to perform write operations.
 * This is suitable for an admin-managed application where all logged-in
 * users are considered administrators.
 *
 * Data Structure:
 * - /routes/{routeId}: Stores route information.
 * - /alerts/{alertId}: Stores alert messages.
 * - /drivers/{driverId}: Stores driver information.
 *
 * Key Security Decisions:
 * - Public read access is granted for all collections.
 * - Write operations (create, update, delete) are restricted to authenticated users.
 *
 * Denormalization for Authorization: N/A (Authorization is based on auth status, not data roles).
 * Structural Segregation: Routes, alerts, and drivers are in separate collections, each with its own access policy.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Allows public read access, but restricts writes to authenticated users.
     * @path /routes/{routeId}
     */
    match /routes/{routeId} {
      allow get, list: if true;
      allow write: if request.auth != null;
    }

    /**
     * @description Allows public read access, but restricts writes to authenticated users.
     * @path /alerts/{alertId}
     */
    match /alerts/{alertId} {
      allow get, list: if true;
      allow write: if request.auth != null;
    }

     /**
     * @description Allows public read access, but restricts writes to authenticated users.
     * @path /drivers/{driverId}
     */
    match /drivers/{driverId} {
      allow get, list: if true;
      allow write: if request.auth != null;
    }
  }
}
