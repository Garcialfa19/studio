{
  "entities": {
    "Route": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Route",
      "type": "object",
      "description": "Represents a bus route with its details.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the route."
        },
        "nombre": {
          "type": "string",
          "description": "Name of the route (origin â€“ destination)."
        },
        "duracionMin": {
          "type": "number",
          "description": "Duration of the route in minutes."
        },
        "tarifaCRC": {
          "type": "number",
          "description": "Fare of the route in Costa Rican Colones."
        },
        "imagenHorarioUrl": {
          "type": "string",
          "description": "URL of the schedule image for the route.",
          "format": "uri"
        },
        "activo": {
          "type": "boolean",
          "description": "Indicates whether the route is currently active."
        },
        "lastUpdated": {
          "type": "string",
          "description": "Timestamp of the last update to this route.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "nombre",
        "duracionMin",
        "tarifaCRC",
        "imagenHorarioUrl",
        "activo"
      ]
    },
    "Alert": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Alert",
      "type": "object",
      "description": "Represents an alert message displayed to users.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the alert."
        },
        "titulo": {
          "type": "string",
          "description": "Title of the alert."
        },
        "mensaje": {
          "type": "string",
          "description": "Message content of the alert."
        },
        "severidad": {
          "type": "string",
          "description": "Severity level of the alert (info, warning, critical).",
          "format": "string"
        },
        "iniciaISO": {
          "type": "string",
          "description": "ISO timestamp when the alert becomes active.",
          "format": "date-time"
        },
        "terminaISO": {
          "type": "string",
          "description": "ISO timestamp when the alert expires.",
          "format": "date-time"
        },
        "activo": {
          "type": "boolean",
          "description": "Indicates whether the alert is currently active and displayed to users."
        },
        "lastUpdated": {
          "type": "string",
          "description": "Timestamp of the last update to this alert.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "titulo",
        "mensaje",
        "severidad",
        "iniciaISO",
        "terminaISO",
        "activo"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/routes/{routeId}",
        "definition": {
          "entityName": "Route",
          "schema": {
            "$ref": "#/backend/entities/Route"
          },
          "description": "Stores route information. Includes route details such as name, duration, fare, schedule image URL, and active status.",
          "params": [
            {
              "name": "routeId",
              "description": "Unique identifier for the route."
            }
          ]
        }
      },
      {
        "path": "/alerts/{alertId}",
        "definition": {
          "entityName": "Alert",
          "schema": {
            "$ref": "#/backend/entities/Alert"
          },
          "description": "Stores alert messages. Includes title, message, severity, start and end timestamps, and active status.",
          "params": [
            {
              "name": "alertId",
              "description": "Unique identifier for the alert."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to support the ASG Digital application's requirements for managing routes and alerts, while adhering to the principles of Authorization Independence and Structural Segregation. The structure includes separate collections for `routes` and `alerts`. No user specific data is stored, there is no need to complicate the structure with users or roles. The data can be managed by an admin, who logs in with hardcoded credentials as specified. Alerts and Routes are global for all users and do not require specific user roles or ownership. This eliminates authorization dependencies and simplifies the security rules. The app stores public data only.\n\n**Authorization Independence:** Since the application has no user specific data or roles (DBAC), the security rules will be simple and independent of document data, using only `allow read, write: if false;` for public read-only collections. If admin data were to be added to the app, roles would need to be implemented. For example:\n*   `/roles_admin/{uid}` could be used to determine if the user is an admin by checking the existence of the document.\n\n**Structural Segregation:** The `routes` and `alerts` collections are segregated, each having distinct data models and access requirements. This segregation simplifies the security rules, as each collection can be secured independently based on its specific needs.\n\n**QAPs Support:** The segregation strategy ensures that `list` operations are secure. Since the data is public, simple rules can be used to control access to each collection.\n\n**Data Clarity and Predictability:** The schema for each entity (`Route` and `Alert`) is well-defined, with explicit state modeling using the `activo` boolean field and semantic naming conventions for all fields.  Timestamps (`lastUpdated`, `iniciaISO`, `terminaISO`) provide audit information and aid in debugging."
  }
}